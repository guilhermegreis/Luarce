<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Carrinho</title>
    <!-- Link Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Link Google Fonts e adição da fonte Quicksand que por algum motivo não funcionava somente com o link -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
     <!-- FAVICONs .SVG (16 a 512) -->
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON16X16.svg" sizes="16x16" type="image/svg">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON32X32.svg" sizes="32x32" type="image/svg">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON48X48.svg" sizes="48x48" type="image/svg">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON64X64.svg" sizes="64x64" type="image/svg">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON128X128.svg" sizes="128x128" type="image/svg">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON256X256.svg" sizes="256x256" type="image/svg">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON512X512.svg" sizes="512x512" type="image/svg">
    <!-- FAVICONs .ICO (16 a 256) -->
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON16X16.ico" sizes="16x16" type="image/x-ico">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON32X32.ico" sizes="32x32" type="image/x-ico">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON48X48.ico" sizes="48x48" type="image/x-ico">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON64X64.ico" sizes="64x64" type="image/x-ico">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON128X128.ico" sizes="128x128" type="image/x-ico">
    <link rel="icon" href="/Luarce/Imagens/FAVICON/FAVICON256X256.ico" sizes="256x256" type="image/x-ico">
    <!-- Link do .CSS da página -->
    <link rel="stylesheet" href="/Luarce/CARRINHO/Carrinho.css">

    <link rel="preload" href="/Luarce/Imagens/Logo.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/Favoritos.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/Usuario.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/Carrinho.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/Favoritos2.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/Usuario2.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/Carrinho3.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/CarrinhoCarrinho.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/Logo_Carousel.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/footer.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/270X270_Vanilla.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/LogoRedonda.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/Carrinho2.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/Instagram.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/WhatsApp.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/Email.svg" as="image">
    <link rel="preload" href="/Luarce/Imagens/TikTok.svg" as="image">


</head>

<body>

	<!-- HEADER -->
    <header class="d-flex hide" >

        <!-- Logo Principal -->
        <a href="/Luarce/index.html"><img class="Logo" src="/Luarce/Imagens/Logo.svg" alt="Logo"></a>
        <div class="d-flex OpcoesHeader">
            <a href="/Luarce/index.html">Home</a>
            <a href="/Luarce/CATÁLOGO/Catalogo.html">Catálogo</a>
            <a href="/Luarce/GLOSSÁRIO/Glossario.html">Glossário</a>
            <a href="/Luarce/ERRO.html">Blog</a>
        </div>
        <div class="d-flex SimbolosHeader">
            <a href="/Luarce/ERRO.html"><img class="Favoritos" id="favoritos-icon" src="/Luarce/Imagens/Favoritos.svg" alt=""></a>
            <a href="/Luarce/REGISTRO/CadastroLogin.html"><img class="Usuario" id="usuario-icon" src="/Luarce/Imagens/Usuario.svg" alt=""></a>
            <a href="/Luarce/CARRINHO/Carrinho.html"><img class="Carrinho" id="carrinho-icon" src="/Luarce/Imagens/Carrinho.svg" alt=""></a>
        </div>

    </header>

    <main id="main-content">
        <div class="paginas">
            <a href="/Luarce/index.html">Home</a>
            <p class="setaDireita2">></p> 
            <p class="pgAtual"><a href="/Luarce/CARRINHO/Carrinho.html">Carrinho</a></p>
        </div>
        <section class="Produto-con">
            <h1>Carrinho</h1>
            <div class="Produto-esq">
                <div class="JanelaProdutos" id="product-window">
                    <h2 class="produtoTitulo">Produtos</h2>
                    <div class="Products"></div>
                    <a href="/Luarce/index.html" class="continuar">Continuar comprando</a>
                </div>
            </div>
            <div class="Produto-dir">
                <div class="JanelaFinalizar">
                    <h2 class="estipularFrete">Estipular frete</h2>
                    <div class="adentro">
                        <div class="d-flex CEP-control">
                            <input id="CEP" required placeholder="CEP (XXXXX-XXX)">
                            <div class="Calcular"><button>Calcular</button></div>
                        </div>
                        <div class="horizontal-line-container">
                            <div id="hl2" class="horizontal-line"></div>
                        </div>
                        <div class="Frete" id="FreteMessage"></div>
                        <div class="Total">
                            <h5>Total:</h5>
                            <h5 id="Num">R$ 0,00</h5>
                        </div>
                        <a class="Finalizar" id="finalizar-button" href="/Luarce/PEDIDO/Pedido.html">Finalizar</a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- ONDA DO FOOTER -->
    <div>
        <img class="onda full-width-img" src="/Luarce/Imagens/footer.svg" alt="">
    </div>

    <!-- FOOTER -->
    <footer class="d-flex align-items-center">

        <h1 class="Direitos text-center">© 2024 Luarce. Todos os direitos reservados.</h1>
        <div class="d-flex align-items-center ConteudoFooter">
            <div class="OpcoesFooter d-flex">
                <a href="/Luarce/ERRO.html">Termos e Condições</a>
                <a href="/Luarce/ERRO.html">Nossos Serviços</a>
                <a href="/Luarce/ERRO.html">Política de Privacidade</a>
                <a href="/Luarce/ERRO.html">Sobre Nós</a>
                <a href="/Luarce/ERRO.html">Suporte</a>
            </div>
            <div class="vertical-line"></div>
            <!-- Links das redes -->
            <div class="d-flex SimbolosFooter">
                <a><img class="Email" src="/Luarce/Imagens/Email.svg" alt="Email"></a>
                <a class="Gmail">Luarce@gmail.com</a>
                <a href="https://www.instagram.com/luarcevelas/" target="_blank" rel="noopener noreferrer"><img class="Instagram" src="/Luarce/Imagens/Instagram.svg" alt="Instagram"></a>
                <a href="https://www.tiktok.com/@luarcevelas" target="_blank" rel="noopener noreferrer"><img class="Tiktok" src="/Luarce/Imagens/TikTok.svg" alt="TikTok"></a>
                <a href="/Luarce/ERRO.html" target="_blank" rel="noopener noreferrer"><img class="WhatsApp" src="/Luarce/Imagens/WhatsApp.svg" alt="WhatsApp"></a>
            </div>
            <div>
                <!-- Logo do footer -->
                <a href="/Luarce/index.html"><img class="LogoRedonda" src="/Luarce/Imagens/LogoRedonda.svg" alt=""></a>
            </div>
        </div>

    </footer>

    <script>
        // Function to preload images
        function preloadImages(srcArray) {
            srcArray.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        }
    
        // Preload hover images
        preloadImages([
            '/Luarce/Imagens/Favoritos2.svg',
            '/Luarce/Imagens/Usuario2.svg',
            '/Luarce/Imagens/Carrinho3.svg',
        ]);
    
        document.getElementById('favoritos-icon').addEventListener('mouseover', function() {
            this.src = '/Luarce/Imagens/Favoritos2.svg';
        });
        document.getElementById('favoritos-icon').addEventListener('mouseout', function() {
            this.src = '/Luarce/Imagens/Favoritos.svg';
        });
    
        document.getElementById('usuario-icon').addEventListener('mouseover', function() {
            this.src = '/Luarce/Imagens/Usuario2.svg';
        });
        document.getElementById('usuario-icon').addEventListener('mouseout', function() {
            this.src = '/Luarce/Imagens/Usuario.svg';
        });
    
        document.getElementById('carrinho-icon').addEventListener('mouseover', function() {
            this.src = '/Luarce/Imagens/Carrinho3.svg';
        });
        document.getElementById('carrinho-icon').addEventListener('mouseout', function() {
            this.src = '/Luarce/Imagens/Carrinho.svg';
        });

    </script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let frete = 0; // Variável global para armazenar o valor do frete
        const productsContainer = document.querySelector('.Products');
        const mainContent = document.querySelector('main');
        const productWindow = document.querySelector('.JanelaProdutos');
        const cepInput = document.getElementById('CEP');
        const calcularButton = document.querySelector('.Calcular button');
        const freteMessage = document.getElementById('FreteMessage');
        const janelaFinalizar = document.querySelector('.JanelaFinalizar');
        const finalizarButton = document.getElementById('finalizar-button');
        
        const updateCart = () => {
            localStorage.setItem('cart', JSON.stringify(cart));
            const total = cart.reduce((sum, product) => sum + (product.price * product.quantity), 0) + frete;
            document.getElementById('Num').textContent = `R$ ${total.toFixed(2)}`;
            adjustHeights();
            toggleFinalizarButton();
        };
    
        const adjustHeights = () => {
            const productCount = cart.length;
            if (productCount === 0) {
                mainContent.style.height = '620px';
                productWindow.style.height = '475px';
            } else {
                const mainHeight = 470 + (productCount * 130);
                const productWindowHeight = 145 + (productCount * 195);
    
                mainContent.style.height = `${mainHeight}px`;
                productWindow.style.height = `${productWindowHeight}px`;
            }
        };
    
        const renderCart = () => {
            productsContainer.innerHTML = '';
            if (cart.length === 0) {
                productsContainer.innerHTML = ` <div class="Vazio">
                                                    <img id="CarrinhoCarrinho" src="/Luarce/Imagens/CarrinhoCarrinho.svg" alt="Carrinho">
                                                    <p id="MensagemCarrinho"> Parece que seu carrinho ainda<br>está vazio...</p> 
                                                </div>
                                                <div class="horizontal-line-container">
                                                    <div class="horizontal-line"></div>
                                                </div>
                                              `;
            } else {
                cart.forEach((product, index) => {
                    const productCard = `
                        <div class="product-card">
                            <img class="imgProduto" src="/Luarce/Imagens/270X270_Vanilla.svg">
                            <div class="infos">
                                <h3>${product.name}</h3>
                                <div class="Descricao">
                                    <p>Tamanho: ${product.tamanho}</p>
                                    <p>Pavio: ${product.pavio}</p>
                                </div>
                                <div class="QtdNum"> 
                                    <div class="arrow" id="arrow" data-index="${index}" data-action="decrease"><</div>
                                    <div>${product.quantity}x</div>
                                    <div class="arrow" id="arrow" data-index="${index}" data-action="increase">></div>
                                    <h4>R$ ${(product.price * product.quantity).toFixed(2)}</h4>
                                </div>
                            </div>
                        </div>
                        <div class="horizontal-line-container">
                            <div class="horizontal-line"></div>
                        </div>
                    `;
                    productsContainer.insertAdjacentHTML('beforeend', productCard);
                });
            }
            attachEventListeners();
            adjustHeights();
        };
    
        const attachEventListeners = () => {
            document.querySelectorAll('.arrow').forEach(arrow => {
                arrow.addEventListener('click', (e) => {
                    const index = e.target.dataset.index;
                    const action = e.target.dataset.action;
                    if (action === 'decrease') {
                        if (cart[index].quantity > 1) {
                            cart[index].quantity -= 1;
                        } else {
                            cart.splice(index, 1);
                        }
                    } else if (action === 'increase') {
                        cart[index].quantity += 1;
                    }
                    updateCart();
                    renderCart();
                });
            });
        };
    
        const formatCEP = (cep) => {
            return cep.replace(/^(\d{5})(\d{3})$/, '$1-$2');
        };
    
        const validateCEP = (cep) => {
            return /^\d{5}-\d{3}$/.test(cep);
        };
    
        const calcularFrete = () => {
            const cep = cepInput.value;
            if (!validateCEP(cep)) {
                alert('Por favor, insira um CEP válido com 8 caracteres.');
                return;
            }
            const cepNumero = parseInt(cep.replace('-', ''), 10);
            if (cepNumero >= 88000000 && cepNumero <= 89999999) {
                freteMessage.innerHTML = '<h5>Frete: R$ 15,00</h5>';
                frete = 15.00;
            } else {
                freteMessage.innerHTML = '<h5>Frete: R$ 30,00</h5>';
                frete = 30.00;
            }
            updateCart();
            ajustarJanelaFinalizar();
        };
    
        const ajustarJanelaFinalizar = () => {
            janelaFinalizar.style.height = `${janelaFinalizar.offsetHeight + 20}px`;
        };
    
        const toggleFinalizarButton = () => {
            if (cart.length === 0) {
                finalizarButton.classList.add('disabled');
                finalizarButton.removeAttribute('href');
            } else {
                finalizarButton.classList.remove('disabled');
                finalizarButton.setAttribute('href', '/Luarce/PEDIDO/Pedido.html');
            }
        };
    
        cepInput.addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 5) {
                value = value.slice(0, 5) + '-' + value.slice(5, 8);
            }
            e.target.value = value;
        });
    
        calcularButton.addEventListener('click', calcularFrete);
    
        renderCart();
        updateCart();
    });
    </script>

</body>
</html>